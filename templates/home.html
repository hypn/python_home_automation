{% extends "layout.html" %}
{% block content %}
<html>
<head>
<title>Home Automator 1.0</title>
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<script src="jquery.js" type="text/javascript"></script>
<style type="text/css">
/* These imageless css buttons were generated by CSSButtonGenerator.com */
.off_button{-moz-box-shadow:inset 0 1px 1px 1px #f29c93;-webkit-box-shadow:inset 0 1px 1px 1px #f29c93;box-shadow:inset 0 1px 1px 1px #f29c93;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#fe1a00),color-stop(1,#ce0100));background:-moz-linear-gradient(center top,#fe1a00 5%,#ce0100 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#fe1a00',endColorstr='#ce0100');background-color:#fe1a00;-moz-border-radius:6px;-webkit-border-radius:6px;border-radius:6px;border:1px solid #d83526;display:inline-block;color:#fff;font-family:arial;font-size:15px;font-weight:bold;padding:6px 24px;text-decoration:none;text-shadow:1px 1px 0 #555555}.off_button:hover{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#ce0100),color-stop(1,#fe1a00));background:-moz-linear-gradient(center top,#ce0100 5%,#fe1a00 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ce0100',endColorstr='#fe1a00');background-color:#ce0100}.off_button:active{position:relative;top:1px}
.on_button{-moz-box-shadow:inset 0 1px 1px 1px #caefab;-webkit-box-shadow:inset 0 1px 1px 1px #caefab;box-shadow:inset 0 1px 1px 1px #caefab;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#77d42a),color-stop(1,#5cb811));background:-moz-linear-gradient(center top,#77d42a 5%,#5cb811 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#77d42a',endColorstr='#5cb811');background-color:#77d42a;-moz-border-radius:6px;-webkit-border-radius:6px;border-radius:6px;border:1px solid #268a16;display:inline-block;color:#fff;font-family:arial;font-size:15px;font-weight:bold;padding:6px 24px;text-decoration:none;text-shadow:1px 1px 0 #555555}.on_button:hover{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#5cb811),color-stop(1,#77d42a));background:-moz-linear-gradient(center top,#5cb811 5%,#77d42a 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#5cb811',endColorstr='#77d42a');background-color:#5cb811}.on_button:active{position:relative;top:1px}

body {
  font-family: Verdana, Arial, Helvetica, sans-serif;
  color: #ffffff;
  background-color: #000000;
}
table
{
  border-collapse: collapse;
  width: 100%;
}
tr {
  line-height: 24px;
}
tr.alt {
  background-color: #343434;
}
td {
  padding: 5px;
  text-align: center;
  vertical-align: middle;
}
#icon {
  padding-right: 5px;
  width: 16px;
}
</style>
</head>
<body>

<table id="controls" border="0">
</table>

<script>
for (var i=1;i<=8;i++)
{
  var table = document.getElementById("controls");
  var row = table.insertRow(-1);
  row.id = "row"+i;
  if (i % 2 == 0)
  {
    row.className = "alt";
  }

  var cell1 = row.insertCell(0);
  var cell2= row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);

  cell1.innerHTML = '<span id="icon"><img src="/lightbulb-off-icon.png"></span><strong>Lights #'+i+'</strong>';
  cell2.innerHTML = "&nbsp;";
  cell3.innerHTML = '<a href="/on/'+i+'" class="on_button">On</button>';
  cell4.innerHTML = '<a href="/off/'+i+'" class="off_button">Off</button>';
}
</script>

<script>
function image_tag(data) {
  if (data == 'on') {
    return('<img src="/lightbulb-icon.png">');
  }
  else if (data == 'off') {
    return('<img src="/lightbulb-off-icon.png">');
  }
  else {
    return('<img src="/exclamation-icon.png">');  
  }
}

function update_icon(pin)
{
  var url = '/status/'+pin;
  var icon = $('#row'+pin+' #icon');
  $.get(url, function(data) {
    img = image_tag(data);
    $(icon).html(img);
  });
}

$('.on_button').click(function() {
  var url = $(this).attr("href");
  var icon = $(this).closest('tr').find('#icon');
  $.get(url, function(data) {
    $(icon).html(image_tag(data));
  });
  return false;
});

$('.off_button').click(function() {
  var url = $(this).attr("href");
  var icon = $(this).closest('tr').find('#icon');
  $.get(url, function(data) {
    $(icon).html(image_tag(data));
  });
  return false;
});

for (var i=1;i<=8;i++) {
  update_icon(i);
}
</script>

</body>
</html>{% endblock %}
